<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="Bharath(yamakira_)">
  
  <title>Scapy Intro - The Art of Packet Crafting with Scapy!</title>
  

  <link rel="shortcut icon" href="../../img/favicon.ico">

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">

  
  <script>
    // Current page data
    var mkdocs_page_name = "Scapy Intro";
    var mkdocs_page_input_path = "scapy/scapy_intro.md";
    var mkdocs_page_url = "/scapy/scapy_intro/index.html";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script>
  <script src="../../js/theme.js"></script> 

  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../../index.html" class="icon icon-home"> The Art of Packet Crafting with Scapy!</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul class="current">
          
            <li>
    <ul class="subnav">
    <li><span>Workshop intro</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../index.html">The Art of Packet Crafting with Scapy</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../workshop_intro/license/index.html">License</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../workshop_intro/bigger_picture/index.html">Bigger picture</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../workshop_intro/speakers/index.html">Speakers</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../workshop_intro/workshop_settings/index.html">Workshop settings</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../workshop_intro/disclaimer/index.html">Disclaimer</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Lab setup</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../lab_setup/lab_setup/index.html">Mysterious boxes</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../lab_setup/network_hunt/index.html">Network Hunt</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Networking</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../networking/layers/index.html">Layers</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../networking/socket_interface/index.html">Socket Interface</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../networking/packet_headers/index.html">Packet Headers</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../networking/protocols/index.html">Protocols</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Python</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../python/python/index.html">Python</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Scapy</span></li>

        
            
    <li class="toctree-l1 current">
        <a class="current" href="index.html">Scapy Intro</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#scapy-intro">Scapy - Intro</a></li>
                
                    <li><a class="toctree-l4" href="#trivia">Trivia</a></li>
                
                    <li><a class="toctree-l4" href="#overview">Overview</a></li>
                
                    <li><a class="toctree-l4" href="#whats-different-about-scapy">What's different about Scapy?</a></li>
                
                    <li><a class="toctree-l4" href="#scapy-limitations">Scapy Limitations</a></li>
                
            
            </ul>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../scapy_modes/index.html">Scapy Modes</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../scapy_exploring/index.html">Exploring scapy</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../creating_packets/index.html">Creating packets</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../inspecting_packets/index.html">Inspecting packets</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../sending_recieving/index.html">Sending & Recieving</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../import_export/index.html">Import & Export data</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../sniffing/index.html">Sniffing</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Network recon</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../network_recon/host_discovery/index.html">Host discovery</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../network_recon/service_discovery/index.html">Service discovery</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../network_recon/os_detection/index.html">OS detection</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../network_recon/promisc/index.html">Promisc detection</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../network_recon/pcap_analysis/index.html">PCAP Analysis</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../network_recon/traceroute/index.html">Traceroute</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Network attacks</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../network_attacks/cam_overflow/index.html">CAM overflow</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../network_attacks/arp_spoofing/index.html">ARP spoofing</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Misc libraries</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../libraries/netaddr/index.html">netaddr</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../libraries/netifaces/index.html">netifaces</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Exercises</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../exercises/misc_exercises/index.html">Misc exercises</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../exercises/network_hunt/index.html">Network Hunt</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Epilogue</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../epilogue/moving_forward/index.html">Moving forward</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../epilogue/feedback/index.html">Feedback</a>
        
    </li>

        
    </ul>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">The Art of Packet Crafting with Scapy!</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
    
      
        
          <li>Scapy &raquo;</li>
        
      
    
    <li>Scapy Intro</li>
    <li class="wy-breadcrumbs-aside">
      
        
          <a href="https://github.com/yamakira/art-of-packet-crafting-with-scapy" class="icon icon-github"> Edit on GitHub</a>
        
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="scapy-intro">Scapy - Intro</h1>
<h2 id="trivia">Trivia</h2>
<ul>
<li>Scapy is packet crafting, manipulating and analysis suite . </li>
<li>Python interpreter disguised as a Domain Specific Language. </li>
<li>Created by Philippe Biondi.</li>
</ul>
<h2 id="overview">Overview</h2>
<ul>
<li>Helps to forge packets, send &amp; recieve packets, R&amp;W pcaps, alter packets.</li>
<li>Easy &amp; faster packet desgining.</li>
<li>Dozens of in-built functions to automate various network utilities/attacks..</li>
</ul>
<h2 id="whats-different-about-scapy">What&rsquo;s different about Scapy?</h2>
<p>You might be wondering that there are dozens of packet crafting tools, network scanners so why should we use Scapy?</p>
<ul>
<li>
<p>Scapy is not just another packet crafting tool, it comes with a lot of new concepts and paradigms.</p>
</li>
<li>
<p>Scapy is not desgined as a simple but rather a framework upon which you can build other custom tools.</p>
</li>
</ul>
<h4 id="absolute-freedom-over-packets">Absolute freedom over packets</h4>
<ul>
<li>A lot of packet crafting tools does not have a way to set certain fields in packets(limitations of sock_raw) i.e. the kernel is still in control of ceratin fields and will calculate those fields on behalf of the tool(cheksums, IHL)</li>
<li>Most packet crating tools let&rsquo;s you fiddle with only limited fields/protocols, it is impossible to stack unrelated protocol headers into a single packet.</li>
</ul>
<p>Try to find a tool that can do</p>
<ul>
<li>an ICMP echo request with some given padding data</li>
<li>an IP protocol scan with the More Fragments flag</li>
<li>some ARP cache poisoning with a VLAN hopping attack</li>
<li>a traceroute with an applicative payload (DNS, ISAKMP, etc.)</li>
</ul>
<p>Scapy tries to overcome those problems. It enables you to build exactly the packets you want. Even if I think stacking a 802.1q layer on top of TCP has no sense, it may have some for somebody else working on some product I don’t know. Scapy has a flexible model that tries to avoid such arbitrary limits. You’re free to put any value you want in any field you want, and stack them like you want. You’re an adult after all.</p>
<h4 id="decode-not-interpret">Decode, Not Interpret</h4>
<p><strong>Tool that interprets         - </strong> “The port 80 is filtered” <br>
<strong>Tool that decodes            - </strong> “I have recieved ICMP type 3; code 13 from port 80”</p>
<ul>
<li>Having a tool that interprets is convenient but it is not the the best approach all the time.</li>
<li>Tools interpret results based on the tool authors logic but every network is unique, one interpretation does not fit all the senarios.</li>
<li>Interpreting results can help users that don’t know what a port scan is but it can also make more harm than good, as it injects bias into the results. A more knowledgable penetration tester woud want to see all the information and make interpretation himself. Unfortunately many tools discard most information that is needed.</li>
<li>Networks are complex especially with the advent of firewalls, cloud infrastructure etc so each pen test is unique and you have to pay attention to even the minute details rather than relying on some tools interpretation blindly.</li>
</ul>
<h4 id="fast-packet-desgining-power-of-python">Fast packet desgining &amp; power of Python</h4>
<p>Other tools stick to the program-that-you-run-from-a-shell paradigm. The result is an awful syntax to describe a packet. For these tools, the solution adopted uses a higher but less powerful description, in the form of scenarios imagined by the tool’s author. As an example, only the IP address must be given to a port scanner to trigger the port scanning scenario. Even if the scenario is tweaked a bit, you still are stuck to a port scan.</p>
<p>Scapy is not a simple shell command program; <strong>Scapy runs inside Python interpreter</strong>, provides you the whole language when dealing with packets but you don’t need to master Python to use Scapy though.</p>
<p>Scapy’s paradigm is to propose a Domain Specific Language (DSL) that enables a powerful and fast description of any kind of packet. Using the Python syntax and a Python interpreter as the DSL syntax and interpreter has many advantages: there is no need to write a separate interpreter, users don’t need to learn yet another language and they benefit from a complete, concise and very powerful language.</p>
<h4 id="probe-once-interpret-many-times">Probe Once, Interpret Many Times.</h4>
<p>Network recon/Network mapping is not simply scanning ports, it&rsquo;s far more complex and involves techniques like TTL analysis, understanding IP based trust relationships in the network etc.</p>
<p>Unlike many tools, which discard all the information which they deem irrelavent, Scapy gives all the information, i.e. all the stimuli sent and all the responses received. Scapy gives the complete raw data, which can be used many times during analysis. You&rsquo;ll have all the Power of Python to dig through the data and perform analysis.</p>
<h2 id="scapy-limitations">Scapy Limitations</h2>
<ul>
<li>
<p>Scapy is not designed for fast throughput. It&rsquo;s written in Python which comes with many layers of abstraction.</p>
</li>
<li>
<p>Scapy does not go easy on memory(Each packet is a class instance). Not a right choice for analysing large packet captures.</p>
</li>
</ul>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../scapy_modes/index.html" class="btn btn-neutral float-right" title="Scapy Modes">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../../python/python/index.html" class="btn btn-neutral" title="Python"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/yamakira/art-of-packet-crafting-with-scapy" class="icon icon-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../../python/python/index.html" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../scapy_modes/index.html" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>

</body>
</html>
